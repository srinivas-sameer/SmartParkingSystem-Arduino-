#include<SoftwareSerial.h>
SoftwareSerial nodemcu(2,3);

int parking1_slot1_ir_s = 3;
int parking1_slot2_ir_s = 4;
int parking1_slot3_ir_s = 5;
int parking2_slot1_ir_s = 7;
int parking2_slot2_ir_s = 8;
int parking2_slot3_ir_s = 9;
String sensor1;
String sensor2;
String sensor3;
String sensor4;
String sensor5;
String sensor6;

String cdata = "";
void setup(){
  Serial.begin(9600);
  nodemcu.begin(9600);
  pinMode(parking1_slot1_ir_s, INPUT);
  pinMode(parking1_slot2_ir_s, INPUT);
  pinMode(parking1_slot3_ir_s, INPUT);
  pinMode(parking2_slot1_ir_s, INPUT);
  pinMode(parking2_slot2_ir_s, INPUT);
  pinMode(parking2_slot3_ir_s, INPUT);

  pinMode(13,OUTPUT);
  pinMode(12,OUTPUT);
  pinMode(11,OUTPUT);
}

void loop(){
  p1slot1();
  p1slot2();
  p1slot3();
  p2slot1();
  p2slot2();
  p2slot3();
if(digitalRead(parking1_slot1_ir_s)==LOW &&digitalRead(parking1_slot2_ir_s)==HIGH && digitalRead(parking1_slot3_ir_s)==HIGH){
    cdata = cdata + sensor1 + "," +sensor2 + "," +sensor3 + "," + "  .....slot 1 is full!";
  }

  if(digitalRead(parking1_slot2_ir_s)==LOW &&digitalRead(parking1_slot1_ir_s)==HIGH && digitalRead(parking1_slot3_ir_s)==HIGH){
    cdata = cdata + sensor1 + "," +sensor2 + "," +sensor3 + "," + "  .....slot 2 is full!";
  }
 
  if(digitalRead(parking1_slot3_ir_s)==LOW &&digitalRead(parking1_slot2_ir_s)==HIGH && digitalRead(parking1_slot1_ir_s)==HIGH){
    cdata = cdata + sensor1 + "," +sensor2 + "," +sensor3 + "," + "  .....slot 3 is full!";
  }
  else if(digitalRead(parking1_slot1_ir_s)==LOW && digitalRead(parking1_slot2_ir_s)==LOW && digitalRead(parking1_slot3_ir_s)==HIGH){
    cdata = cdata + sensor1 + "," +sensor2 + "," +sensor3 + "," + "  .....slot 1 and slot 2 are full!";
  }

  else if(digitalRead(parking1_slot2_ir_s)==LOW && digitalRead(parking1_slot3_ir_s)==LOW && digitalRead(parking1_slot1_ir_s)==HIGH){
    cdata = cdata + sensor1 + "," +sensor2 + "," +sensor3 + "," + "  .....slot 2 and slot 3 are full!";
  }

  else if(digitalRead(parking1_slot1_ir_s)==LOW && digitalRead(parking1_slot3_ir_s)==LOW && digitalRead(parking1_slot2_ir_s)==HIGH){
    cdata = cdata + sensor1 + "," +sensor2 + "," +sensor3 + "," + "  .....slot 1 and slot 3 are full!";
  }
  else if(digitalRead(parking1_slot1_ir_s)==LOW &&digitalRead(parking1_slot2_ir_s)==LOW && digitalRead(parking1_slot3_ir_s)==LOW){
    cdata = cdata + sensor1 + "," +sensor2 + "," +sensor3 + "  .....ALL Slots are FULL!" ;
  }
 
else if(digitalRead(parking1_slot1_ir_s)==HIGH &&digitalRead(parking1_slot2_ir_s)==HIGH && digitalRead(parking1_slot3_ir_s)==HIGH){
  cdata = cdata + sensor1 + "," +sensor2 + "," +sensor3 + "  .....ALL Slots are EMPTY!" ;
}
Serial.println(cdata);
nodemcu.println(cdata);
delay(6000);
cdata = "";
digitalWrite(parking1_slot1_ir_s, HIGH);
digitalWrite(parking1_slot2_ir_s, HIGH);
digitalWrite(parking1_slot3_ir_s, HIGH);
digitalWrite(parking2_slot1_ir_s, HIGH);
digitalWrite(parking2_slot2_ir_s, HIGH);
digitalWrite(parking2_slot3_ir_s, HIGH);
}
void p1slot1(){
  if(digitalRead(parking1_slot1_ir_s)==LOW){
    sensor1 = "255";
    digitalWrite(13,HIGH);
    delay(200);
  }
  if(digitalRead(parking1_slot1_ir_s)==HIGH){
    sensor1 = "0";
    digitalWrite(13,LOW);
    delay(200);
  }
}

void p1slot2(){
  if(digitalRead(parking1_slot2_ir_s)==LOW){
    sensor2 = "255";
    digitalWrite(12,HIGH);
    delay(200);
  }
  if(digitalRead(parking1_slot2_ir_s)==HIGH){
    sensor2 = "0";
    digitalWrite(12,LOW);
    delay(200);
  }
}
void p1slot3(){
  if(digitalRead(parking1_slot3_ir_s)==LOW){
    sensor3 = "255";
    digitalWrite(11,HIGH);
    delay(200);
  }
  if(digitalRead(parking1_slot3_ir_s)==HIGH){
    sensor3 = "0";
    digitalWrite(11,LOW);
    delay(200);
  }
}
void p2slot1(){
  if(digitalRead(parking2_slot1_ir_s)==LOW){
    sensor4 = "255";
    delay(200);
  }
  if(digitalRead(parking2_slot1_ir_s)==HIGH){
    sensor4 = "0";
    delay(200);
  }
}
void p2slot2(){
  if(digitalRead(parking2_slot2_ir_s)==LOW){
    sensor5 = "255";
    delay(200);
  }
  if(digitalRead(parking2_slot2_ir_s)==HIGH){
    sensor5 = "0";
    delay(200);
  }
}
void p2slot3(){
  if(digitalRead(parking2_slot3_ir_s)==LOW){
    sensor6 = "255";
    delay(200);
  }
  if(digitalRead(parking2_slot3_ir_s)==HIGH){
    sensor6 = "0";
    delay(200);
  }
}
